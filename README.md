# Nessus Vulnerability Management Project


## Project Overview

**Vulnerability Management** is a proactive information security strategy to continuously to identify, track, prioritize, and remediate security risks to keep your computer systems, networks, and enterprise applications safe from cyber attacks and data breaches.

**Nessus** is one of the most commonly deployed vulnerability management solutions in the world.

This is a simple project to gain basic understanding of the Nessus Vulnerability Scanner. We will download and install Nessus Essential (free version) onto our Kali Linux virtual machine and use it to scan a Windows 10 VM running in Microsoft Azure cloud.

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/nessus-logo.jpg)
<br>
<br>

## Project Architecture

What we will be doing:

1. Register and download Nessus

2. Install and initialize Nessus on Kali Linux

3. Introduce a system vulnerability by installing a 10 years old, deprecated version of Firefox browser to our Windows 10 VM.

4. Configure Nessus and conduct a non-credentialed scan of the Windows VM

5. Configure Nessus and conduct a credentialed scan of the Windows VM

6. Compare the results of the scan

7. Remediate vulnerabilities listed from the scan result

8. Conduct another credentialed scan to see if the vulnerabilities have been fixed.

## Project Process

We will be using Kali Linux to run Nessus Essential in this project. You may use whatever system of your choice. Nessus Essential has installer for Windows, Mac, and Linux systems. It doesn't matter what system you are doing the scan on; however, different systems may have different requirement for running credentialed scan. I've listed the Nessus documentation on credential scan requirements below.

[Download Kali Linux](https://www.kali.org/get-kali/#kali-platforms)

[Download Nessus Essential](https://www.tenable.com/products/nessus/nessus-essentials)

[Download VMware Workstation](https://customerconnect.vmware.com/en/downloads/info/slug/desktop_end_user_computing/vmware_workstation_player/17_0)

[Download Deprecated Firefox Browser](https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US/)

[Nessus Credential Scan Requirements](https://docs.tenable.com/nessus/Content/NessusCredentialedChecks.htm)

### Register and Download Nessus Essential

Head to the Nessus Essential registration page to sign up for it. Once you complete the sign up form, you will receive an email with a one-time activation code that you will be using to install Nessus. The download link is included in the email, as well as the registration confirmation page that you've just filled.

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Nessus-registration.png)

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Nessus-confirmation.png)

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Nessus%20Download%20Link%20Short.png)
<br>
<br>

Follow the link to the download page and grab which ever Nessus version is appropriate for your system. We will be using the Debian/Kali version here.

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Nessus%20Download%20Selector.png)
<br>
<br>

### Install and Initialize Nessus Essential

Navigate to the directory contains the Nessus installer file in the Kali terminal. Use the command 

`sudo apt install ./<YOUR_NESSUS_FILE_NAME>`

Once the installation is complete, you can use the following command to start Nessus:

`systemctl start nessusd.service`

You will need to enter your admin password here to continue.

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Videos/Install%20Nessus.gif)
<br>
<br>

After you've started the Nessus service, go to your internet browser (here we are using Firefox). In the URL bar, type `https://kali:8834` or `https://localhost:8834` to launch Nessus scanner. Use the activation code you've received in your sign-up email to finish the registration. The initialization process may take a few minutes to complete. Now it's a good time to grab a cup of coffee.

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Videos/Nessus%20Initialization.gif)
<br>
<br>

### Introduce vulnerability to Windows VM

Before we start the initial non-credentialed scan, let's introduce a vulnerability that will for sure to trigger a critical warning inside Nessus. The download link is listed above.

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Videos/Install%20Deprecated%20Firefox.gif)
<br>
<br>

### Configure Nessus for Non-Credentialed Scan

Now let's proceed to do our first scan. But before we can configure the scanner. Let's turn off the Windows Defender Firewall to make sure Nessus scanner can ping the Windows VM. Once the Firewall is turned off, we can proceed to do the initial scan.

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Videos/Quick%20Windows%20Scan.gif)
<br>
<br>

As you can see, most of the items in the scan result are very superficial. The scanner also did not catch our induced vulnerability.

### Configure Windows VM for Credentialed Scan

Now let's conduct a credentialed scan. The credentialed scan allow you to use your login information to conduct a deep scan of your system to perform a detailed analysis of your system's security posture.

There are a few changes we need to make to the Windows VM to allow the credentialed scan to happen:

1. Make sure the File and Printer Sharing is turned on.

2. Make sure the "Remote Registry" is enabled and running.

3. Turn off Windows User Account Control (UAC)

4. Add a D-word `LocalAccountTokenFilterPolicy` in the system registry path `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System` and change its value to `1`

Once that's done, head back to Nessus, configure the scan with the Windows VM user credential.

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Videos/Configure%20Windows%20for%20Credential%20Scan.gif)
<br>
<br>

### Credentialed Scan Result

As we can see, the credentialed scan has returned much more information about the system and it has detected our induced vulnerability through the installation of the deprecated Firefox browser. It also recommended solution for remediation.

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Videos/Credential%20Scan%20Result.gif)
<br>
<br>

### Remediation

Let's take Nessus' recommendation to fix the security risk.

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Videos/Removing%20Firefox.gif)
<br>
<br>

### Remediation Scan

Now let's conduct a final scan after the remediation process and see if we get less complaints from Nessus scanner. And indeed, we do. ðŸ™ƒ

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Videos/Final%20Scan%20Result.gif)
<br>
<br>

### Final Result

There we have it folks: a brief introduction to Nessus Vulnerability Management. Here are the scan results side by side.

<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Non_Credential_Scan.png)
<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Credential_Scan_Result.png)
<br>

![](https://github.com/thesimonjiang/Nessus-Vulnerability-Management-Project/blob/9ac70b7f976ee434772fc52118ea7519c63fbf55/Graphics/Final%20Scan.png)
